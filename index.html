<!doctype html>
<html lang="ja">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>HPC向けベンチマークを考えるBoFに参加して思ったこと</title>

		<meta name="description" content="HPC向けベンチマークを考えるBoFに参加して思ったこと" />
		<meta name="author" content="LWisteria" />

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/mystyle.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<style type="text/css">
			.reveal h1
			{
				font-size: 150%;
			}
		</style>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<h1>HPC向けベンチマークを考えるBoFに参加して思ったこと</h1>
					<p>株式会社フィックスターズ</p>
					<p><span style="font-weight: bold">&#x20bb7;藤 尚生 (<a href="https://twitter.com/LWisteria">@LWisteria</a>)</span></p>
					<p><a href="https://connpass.com/event/111162/">SC18勉強会</a>(<time>2018/12/13</time>)</p>
				</section>

				<section>
					<h2>概要</h2>
					<section>
						<h3>注意</h3>
						<p>本内容は、BoFを聴講した作者個人の理解および感想であって、BoFの発表者である先生方や作者の所属機関の見解ではありません</p>
						<p><small>間違ってたらすみません・・・</small></p>
					</section>

					<section>
						<h3>自己紹介</h3>
						<figure>
							<img src="img/avater.JPG" />
							<figcaption>Online ID: <a href="https://twitter.com/LWisteria">@LWisteria</a></figcaption>
						</figure>
						<dl>
							<dt>名前</dt>
							<dd>&#x20bb7;藤 尚生 (YOSHIFUJI, Naoki)</dd>
							<dt>所属</dt>
							<dd>株式会社フィックスターズ ソリューション事業部 リードエンジニア</dd>
							<dt>専門分野</dt>
							<dd>土木工学・計算力学</dd>
							<dd>水理学・海岸工学・河川工学</dd>
							<dd>GPGPU, HPC, CAE</dd>
							<dt>SC参加歴</dt>
							<dd>2回目(SC16, SC18)</dd>
						</dl>
					</section>

					<section>
						<h3>なにしにSCへ？</h3>
						<dl>
							<dt>前回：SC16</dt>
							<dd>ワークショップで発表</dd>
							<dd><a href="http://proc-cpuinfo.fixstars.com/2016/12/sc16-html-2/">Implementation and evaluation of data-compression algorithms for irregular-grid iterative methods on the PEZY-SC processor</a></dd>
							<dt>今回：SC18</dt>
							<dd><del>遊びに</del>情報収集＆日本に持ち帰って社内等へ共有</dd>
						</dl>
					</section>

					<section>
						<h3>今日取り上げるセッション</h3>
						<p>Pros and Cons of HPCx benchmarks</p>
						<p>（HPCxベンチマークの賛否）</p>
						<p>3日目：2018/11/13（火）12:15-13:15 (CST)</p>
						<figure>
							<img src="img/sc18_webpage.png" />
							<figcaption><a href="https://sc18.supercomputing.org/presentation/?id=bof107">https://sc18.supercomputing.org/presentation/?id=bof107</a>より引用</figcaption>
						</figure>
					</section>

					<section>
						<h3>BoFの概要</h3>
						<p>Bird of Feather：発表者たちの自由討論会みたいなもの</p>
						<p>発表者（敬称略、発表順）</p>
						<ul>
							<li>平木 敬（東京大学）</li>
							<li>ウォルター・リウン（SURFsara, PRACE）</li>
							<li>牧野 淳一郎（神戸大学・理化学研究所）</li>
							<li>エリック・ストローマイアー（ローレンス・バークレー国立研究所）</li>
						</ul>
						<p>各発表者のスライドは<a href="http://www.jmlab.jp/?p=828">牧野研のページ</a>にある</p>
					</section>

					<section>
						<h3>BoFの内容</h3>
						<p>Andoさんの記事読んで！！</p>
						<figure>
							<img src="img/ando.png" />
							<figcaption><a href="https://news.mynavi.jp/article/sc18_bof107-1/">https://news.mynavi.jp/article/sc18_bof107-1/</a>より引用</figcaption>
						</figure>
					</section>

					<section>
						<p style="font-size: 300%">ご清聴ありがとうございました</p>
					</section>
				</section>

				<section id="toc">
					<h3>目次</h3>
					<ol class="toc">
						<li>概要</li>
						<li>BoF紹介</li>
						<li>私見と感想</li>
						<li>まとめ</li>
					</ol>
				</section>

				<section>
					<h2>なんかかく</h2>
					<section class="toc">
						<h3>目次</h3>
						<ol class="toc">
							<li>概要</li>
							<li class="recent">BoF紹介</li>
							<li>私見と感想</li>
							<li>まとめ</li>
						</ol>
					</section>

					<section>
						<h3>以下</h3>
						<p>各発表者の内容を（勝手に）まとめて紹介します</p>
						<p>それぞれを時系列で知りたい人はAndoさんの記事を参照してください</p>
					</section>

					<section>
						<h3>今のHPC・スパコン向けベンチマーク</h3>
						<p>主に話題に上がっていたものは以下</p>
						<ul>
							<li>Linpack, HPL, Top500</li>
							<li>HPCC</li>
							<li>NPB</li>
							<li>SPEC</li>
							<li>UEABS</li>
							<li>HPCG</li>
							<li>HPGMG</li>
						</ul>
					</section>

					<section>
						<h3>Linpack, HPL, Top500</h3>
						<p>n次元密行列のLU分解による線形方程式求解のFLOP/sを測定</p>
						<ul>
							<li>Linpack (1979)：最初の実装 in FORTRAN</li>
							<li>High Performance Linkpack (1991)：スパコン向けに書き直した in C言語</li>
							<li>Top500(1993)：ランク付け開始（今に至る）</li>
						</ul>
						<p>全てのHPCベンチマークの原点。議論もここから出発する</p>
					</section>

					<section>
						<h3>HPLの問題点</h3>
						<p>1991年にNPBを作った頃からLinpackは「実アプリと合ってない」と言われていた</p>
						<p>その理由は、ストローマイアー先生まとめ：</p>
						<ul>
							<li>浮動小数点演算に偏りすぎB/F=O(1/n)</li>
							<li>今のアプリは（もう）HPLっぽくない</li>
							<li>直感的な感覚と順位が合ってない</li>
							<li>HPL特化機が簡単に作れてしまう</li>
						</ul>
					</section>

					<section>
						<h3>なぜまだHPLが使われるのか？</h3>
						<p>いろんな計算機に適用しやすいから</p>
						<ol>
							<li>「解くべき問題」だけが決まっている</li>
							<li>ソースコードやアルゴリズムも変えられる（演算量さえ変わってなければ）</li>
							<li>問題規模を、計算機に合わせて変えられる</li>
							<li>出てくる性能がシステム規模に正相関するので、全系の測定が重要</li>
							<li>3,4から、システム規模を変えた時の性能が推測しやすい</li>
							<li>多くの場合DGEMMだけが問題になっているので高速化対象が分かりやすい（一部のメニーコアなアクセラレーター除く）</li>
						</ol>
					</section>

					<section>
						<h3>ではどうするのか？</h3>
						<ul>
							<li>新しいベンチマークを作る</li>
							<li>HPLを含めた複数指標を用いる</li>
						</ul>
					</section>

					<section>
						<h3>新しいベンチマークには何が必要か？</h3>
						<dl>
							<dt>HPLの良いところは引き継ぐ</dt>
							<dd><ul>
								<li>問題規模が可変</li>
								<li>性能はシステム規模に応じて上がる</li>
								<li>ハードウェアの性能が点数に直結しやすい</li>
								<li>最適化の余地がある（コードやアルゴリズムは固定しない）</li>
							</ul></dd>
							<dt>HPLを補間する</dt>
							<dd><ul>
								<li>演算律速ではない</li>
								<li>Top500の順位とは異なる結果</li>
								<li>ベンチマーク特化機が作りづらい</li>
							</ul></dd>
						</dl>
					</section>

					<section>
						<h3>HPCx候補</h3>
						<dl>
							<dt>HPGMG</dt>
							<dd>多重格子法によるポアソン方程式求解</dd>
							<dd>Vサイクルによって、1ベンチマーク中で問題規模が変わるのが特徴</dd>
							<dt>HPCG</dt>
							<dd>多重格子法前処理付共役勾配法による熱伝導方程式求解</dd>
							<dd>HPLの疎行列アルゴリズム版</dd>
							<dd>MGも集団通信も浮動小数点演算もある</dd>
							<dd>受容されつつある・・・？</dd>
						</dl>
					</section>

					<section>
						<h3>HPCGとHPGMGは何を測るのか？</h3>
						<p>B/F性能を測るものである</p>
						<p>→実用的に重要であることが多いメモリ帯域性能を表せている</p>
						<figure>
							<img src="img/bf.jpg" />
							<figcaption>ストローメイヤー先生のスライドより引用（重要な図なので後で自分で作り直したい）</figcaption>
						</figure>
					</section>

					<section>
						<h3>B/Fを上げれば良いのか？</h3>
						<p>違う</p>
						<p>遅い（Fが小さい）のを作れば良くなってしまう</p>
						<p>（既にそういうプロセッサーが生まれつつある、電力効率的な意味で）</p>
						<p>「性能解析の『最大主成分』はやはり演算性能であり、『他の主成分』としてB/Fを使うべき」（ストローメイヤー先生）</p>
					</section>

					<section>
						<h3>アプリ性能は何に律速するのか？</h3>
						<p>現代計算機は複雑なので1つに決められない</p>
						<ul>
							<li>整数・浮動小数点演算</li>
							<li>レジスタ数</li>
							<li>キャッシュ量、幅、階層深さ</li>
							<li>DRAM</li>
							<li>ファイルI/O</li>
							<li>ネットワーク</li>
						</ul>
						<p>京やポスト京の経験から、どれかに絞るのは難しい</p>
					</section>

					<section>
						<h3>複数ベンチマークをまとめる</h3>
						<p>1指標では無理だから、想定アプリのベンチマークを複数まとめればいい</p>
						<ul>
							<li>NASA Parallel Benchmark (1991)</li>
							<li>HPC Collections (2005)</li>
							<li>など...</li>
						</ul>
						<p>→廃れた</p>
						<p>「今」を測れても、将来を測れないから</p>
					</section>

					<section>
						<h3>指標を組み合わせる</h3>
						<p>HPL性能をf、はHPLで測定できない指標を取るベンチマーク性能をxとする</p>
						<p>x/fが大きくなるベンチマークが良い。が・・・</p>
						<ul>
							<li>ハードウェア的にはx/fを上げると消費電力が上がる</li>
							<li>xが難しいので多くのHPCアルゴリズム研究者は、手法を改良して必要x/fを下げようと頑張っている</li>
						</ul>
					</section>

					<section>
						<h3>「今の計算機」を評価したい場合？</h3>
						<p>計算機の調達、借りる計算機の選定・・・</p>
						<p>「今使われる」複数のアプリ性能を総合的に見たい：UEABSなどが適している</p>
					</section>
				</section>

				<section>
					<h2>私見と感想</h2>
					<section class="toc">
						<h3>目次</h3>
						<ol class="toc">
							<li>概要</li>
							<li>BoF紹介</li>
							<li class="recent">私見と感想</li>
							<li>まとめ</li>
						</ol>
					</section>

					<section>
						<h3>私見</h3>
						<ul>
							<li>HPLにはHPLの良さがあり、これからも続けるべきベンチマーク</li>
							<li>「実アプリ性能」を測るベンチマークは難しい</li>
							<li>必要なアプリケーションは時代によって変わるので、実アプリ性能をベンチマークの指標にすべきではないのでは</li>
							<li>アプリケーションによって測定できるハードウェアの何かの性能をベンチマークする</li>
							<li>現時点では「HPLとHPCGの間」というドンガラ先生の趣旨で良さそう。</li>
						</ul>
					</section>

					<section>
						<h3>感想</h3>
						<ul>
							<li>英語難しかった・・・（平木先生の英語が一番聞き取りやすかった）</li>
							<li>紹介しなかったが、展示はとても面白い</li>
							<li>JFK記念館は本気で学べた</li>
							<li>ダラスのバッファロー肉はうまい</li>
						</ul>
					</section>
				</section>

				<section>
					<h2>まとめ</h2>
					<section class="toc">
						<h3>目次</h3>
						<ol class="toc">
							<li>概要</li>
							<li>BoF紹介</li>
							<li>私見と感想</li>
							<li class="recent">まとめ</li>
						</ol>
					</section>

					<section>
						<h3>まとめ</h3>
						<ol style="font-size: 60%">
							<li>HPLに代わるベンチマークはない。HPLにはHPLの良さがあり、必要</li>
							<li>実アプリ性能を表す魔法のベンチマークもない</li>
							<li>HPLの良いところそのままに、HPLが計測できない指標のベンチマークが必要</li>
							<li>HPCGがB/Fを測定できているので、候補？</li>
						</ol>
						<p>SC楽しいのでみんな行きましょう！！</p>
					</section>

					<section>
						<p style="font-size: 300%">return 0;</p>
					</section>
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,
				slideNumber: "h.v",

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				width: 1280,
				height: 720,
				margin: 0,

				dependencies: [
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/math/math.js', async: true }
				]
			});
		</script>
	</body>
</html>
